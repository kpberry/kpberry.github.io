<html>
<head>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="res/math.js" type="text/javascript"></script>
    <script src="js/graphing.js" type="text/javascript"></script>\
    <link rel="stylesheet" type="text/css" href="styles/w3css.css"/>
    <style>
        input:focus {
            outline: none;
        }
    </style>
    <script>
        var resetGraph = function () {
            var expr_y = document.getElementById('fn_y').value || 'sin(x) + cos(y)';
            var math_fn_y = math.compile(expr_y);
            var fn_y = function (x, y) {
                return math_fn_y.eval({'x': x, 'y': y});
            };
            var expr_x = document.getElementById('fn_x').value || '1';
            var math_fn_x = math.compile(expr_x);
            var fn_x = function(x, y) {
                return math_fn_x.eval({'x': x, 'y': y});
            };
            var min_x = +document.getElementById('min_x').value;
            var max_x = +document.getElementById('max_x').value;
            var min_y = +document.getElementById('min_y').value;
            var max_y = +document.getElementById('max_y').value;
            var euler_step = +document.getElementById('euler_step').value;
            var euler_steps = +document.getElementById('euler_steps').value;
            var g = graphing.graph('#chart', fn_y, fn_x,
                [min_x, max_x], [min_y, max_y], euler_step, euler_steps);
            g.clear();
            var steps = +document.getElementById('steps').value;
            if (document.getElementById('field_type').value === 'direction') {
                g.drawDirectionField(steps);
            } else {
                g.drawSlopeField(steps);
            }
            return g;
        };

        window.onload = function () {
            var redrawable = ['fn_y', 'fn_x', 'min_x', 'max_x', 'min_y', 'max_y',
                'steps', 'euler_step', 'euler_steps'];
            for (var i = 0; i < redrawable.length; i++) {
                var cur = document.getElementById(redrawable[i]);
                cur.addEventListener('keydown', function (e) {
                    if (e.keyCode === 13) {
                        resetGraph();
                    }
                });
            }
            resetGraph();
        };
    </script>
</head>
<body>
<div class="w3-panel w3-display-topmiddle w3-col l8 m12 s12 w3-mobile">
    <div class="w3-card-4">
        <nav class="w3-bar w3-red w3-card-2">
            <a href="index.html" class="w3-bar-item w3-button w3-hover-white">Home</a>
            <a href="projects.html"
               class="w3-bar-item w3-button w3-hover-white">Projects</a>
            <a href="resume.html" class="w3-bar-item w3-button w3-hover-white">Resume</a>
        </nav>
        <div class="w3-panel">
            <div class="w3-bar">
                <div class="w3-quarter w3-bar-item">
                    <label for="fn_y">y' = </label>
                </div>
                <div class="w3-rest">
                    <input id="fn_y" type="text" placeholder="sin(x) + cos(y)"
                           class="w3-input w3-border">
                </div>
            </div>
            <div class="w3-bar">
                <div class="w3-quarter w3-bar-item">
                    <label for="fn_x">x' = </label>
                </div>
                <div class="w3-rest">
                    <input id="fn_x" type="text" placeholder="1"
                           class="w3-input w3-border">
                </div>
            </div>
            <hr>
            <div class="w3-row-padding">
                <div class="w3-col m1 s1 l1">
                    <label for="min_x">Min x</label>
                    <input id="min_x" type="number" placeholder="-5" value="-5"
                           class="w3-input w3-border">
                </div>
                <div class="w3-col m1 s1 l1">
                    <label for="max_x">Max x</label>
                    <input id="max_x" type="number" placeholder="5" value="5"
                           class="w3-input w3-border">
                </div>
                <div class="w3-col m1 s1 l1">
                    <label for="min_y">Min y</label>
                    <input id="min_y" type="number" placeholder="-5" value="-5"
                           class="w3-input w3-border">
                </div>
                <div class="w3-col m1 s1 l1">
                    <label for="max_y">Max y</label>
                    <input id="max_y" type="number" placeholder="5" value="5"
                           class="w3-input w3-border">
                </div>
                <div class="w3-col m1 s1 l1">
                    <label for="steps">Steps</label>
                    <input id="steps" type="number" placeholder="40"
                           value="40" class="w3-input w3-border">
                </div>
                <div class="w3-col m2 s2 l2">
                    <label for="euler_steps">Euler Steps</label>
                    <input id="euler_steps" type="number" placeholder="2000"
                           value="2000" class="w3-input w3-border">
                </div>
                <div class="w3-col m2 s2 l2">
                    <label for="euler_step">Euler Step</label>
                    <input id="euler_step" type="number" placeholder="0.01"
                           value="0.01" class="w3-input w3-border">
                </div>
                <div class="w3-rest">
                    <label for="field_type">Field Type</label>
                    <select id="field_type" class="w3-select">
                        <option value="slope" onselect="resetGraph()">Slope
                            Field
                        </option>
                        <option value="direction">
                            Direction Field
                        </option>
                    </select>
                </div>
            </div>
            <hr>
            <div class="w3-center">
                <button onclick="resetGraph()"
                        class="w3-button w3-center w3-block w3-red w3-hover-white">
                    Redraw Graph
                </button>
            </div>
        </div>
        <div class="w3-center w3-container w3-padding-large">
            <svg width="800" height="800" style="border: solid 1px black"
                 id="chart">
            </svg>
        </div>
    </div>
</div>

</body>
</html>
